<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thống kê - EduShare Admin</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;500;600;700&family=Open+Sans:wght@400;500;600&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../css/main.css">
    <link rel="stylesheet" href="css/admin.css">
    <link rel="stylesheet" href="css/toast.css">
    <!-- Chart.js for analytics visualizations -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.7.1/dist/chart.min.js"></script>
</head>
<body class="admin-body">
    <!-- Admin Header -->
    <header class="admin-header">
        <div class="admin-header-content">
            <div class="admin-logo">
                <a href="index.html" class="logo">
                    <div class="logo-icon">E</div>
                    <div class="logo-text">EduShare</div>
                </a>
            </div>
            
            <div class="admin-header-actions">
                <div class="admin-search">
                    <input type="text" placeholder="Tìm kiếm...">
                    <button><i class="fas fa-search"></i></button>
                </div>
                
                <div class="dark-mode-toggle" id="darkModeToggle"></div>
                
                <div class="admin-notifications">
                    <button class="notification-btn">
                        <i class="fas fa-bell"></i>
                        <span class="notification-badge">5</span>
                    </button>
                </div>
                
                <div class="admin-profile">
                    <div class="admin-avatar">
                        <img src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?ixlib=rb-1.2.1&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80" alt="Admin">
                    </div>
                    <div class="admin-info">
                        <span class="admin-name">Nguyễn Văn A</span>
                        <span class="admin-role">Quản trị viên</span>
                    </div>
                    <div class="admin-dropdown">
                        <i class="fas fa-chevron-down"></i>
                    </div>
                </div>
            </div>
        </div>
    </header>
    
    <!-- Admin Container -->
    <div class="admin-container">
        <!-- Sidebar -->
        <aside class="admin-sidebar">
            <nav class="admin-nav">
                <ul class="admin-menu">
                    <li class="admin-menu-item">
                        <a href="index.html">
                            <i class="fas fa-tachometer-alt"></i>
                            <span>Bảng điều khiển</span>
                        </a>
                    </li>
                    <li class="admin-menu-item">
                        <a href="users.html">
                            <i class="fas fa-users"></i>
                            <span>Quản lý người dùng</span>
                        </a>
                    </li>
                    <li class="admin-menu-item">
                        <a href="documents.html">
                            <i class="fas fa-file-alt"></i>
                            <span>Quản lý tài liệu</span>
                        </a>
                    </li>
                    <li class="admin-menu-item">
                        <a href="categories.html">
                            <i class="fas fa-folder"></i>
                            <span>Quản lý danh mục</span>
                        </a>
                    </li>
                    <li class="admin-menu-item">
                        <a href="tags.html">
                            <i class="fas fa-tags"></i>
                            <span>Quản lý tags</span>
                        </a>
                    </li>
                    <li class="admin-menu-item">
                        <a href="comments.html">
                            <i class="fas fa-comments"></i>
                            <span>Quản lý bình luận</span>
                        </a>
                    </li>
                    <li class="admin-menu-item">
                        <a href="reports.html">
                            <i class="fas fa-flag"></i>
                            <span>Báo cáo vi phạm</span>
                        </a>
                    </li>
                    <li class="admin-menu-item active">
                        <a href="statistics.html">
                            <i class="fas fa-chart-bar"></i>
                            <span>Thống kê</span>
                        </a>
                    </li>
                    <!-- Revenue Management Dropdown -->
                    <li class="admin-menu-item has-submenu">
                        <a href="javascript:void(0)">
                            <i class="fas fa-coins"></i>
                            <span>Quản lý doanh thu</span>
                            <i class="fas fa-chevron-down submenu-icon"></i>
                        </a>
                        <ul class="submenu">
                            <li class="submenu-item">
                                <a href="coin-packages.html">
                                    <i class="fas fa-box"></i>
                                    <span>Gói xu</span>
                                </a>
                            </li>
                            <li class="submenu-item">
                                <a href="transactions.html">
                                    <i class="fas fa-exchange-alt"></i>
                                    <span>Giao dịch</span>
                                </a>
                            </li>
                            <li class="submenu-item">
                                <a href="withdrawals.html">
                                    <i class="fas fa-money-bill-wave"></i>
                                    <span>Yêu cầu rút tiền</span>
                                </a>
                            </li>
                        </ul>
                    </li>
                    <li class="admin-menu-item">
                        <a href="settings.html">
                            <i class="fas fa-cog"></i>
                            <span>Cài đặt</span>
                        </a>
                    </li>
                    <li class="admin-menu-item">
                        <a href="../index.html">
                            <i class="fas fa-sign-out-alt"></i>
                            <span>Đăng xuất</span>
                        </a>
                    </li>
                </ul>
            </nav>
        </aside>
        
        <!-- Main Content -->
        <main class="admin-content">
            <div class="admin-content-header">
                <h1 class="admin-page-title">Thống kê</h1>
                <div class="admin-breadcrumbs">
                    <a href="index.html">Admin</a>
                    <span>/</span>
                    <span>Thống kê</span>
                </div>
            </div>
            
            <!-- Date Range Picker -->
            <div class="date-filter">
                <div class="date-picker">
                    <div class="date-inputs">
                        <div class="date-field">
                            <label for="startDate">Từ ngày</label>
                            <input type="date" id="startDate" value="2023-04-01">
                        </div>
                        <div class="date-separator"></div>
                        <div class="date-field">
                            <label for="endDate">Đến ngày</label>
                            <input type="date" id="endDate" value="2023-04-30">
                        </div>
                    </div>
                </div>
                <div class="time-presets">
                    <button class="time-preset active" data-days="30">30 ngày</button>
                    <button class="time-preset" data-days="90">3 tháng</button>
                    <button class="time-preset" data-days="180">6 tháng</button>
                    <button class="time-preset" data-days="365">1 năm</button>
                </div>
                <button class="apply-filter-btn">Áp dụng</button>
            </div>
            
            <!-- Stats Summary -->
            <div class="stats-summary">
                <div class="stat-card">
                    <div class="stat-icon users-icon">
                        <i class="fas fa-users"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-title">Người dùng mới</div>
                        <div class="stat-value">1,245</div>
                        <div class="stat-trend positive">
                            <i class="fas fa-arrow-up"></i> 13.2% 
                            <span class="trend-period">so với tháng trước</span>
                        </div>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon documents-icon">
                        <i class="fas fa-file-alt"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-title">Tài liệu đăng mới</div>
                        <div class="stat-value">3,782</div>
                        <div class="stat-trend positive">
                            <i class="fas fa-arrow-up"></i> 8.7% 
                            <span class="trend-period">so với tháng trước</span>
                        </div>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon downloads-icon">
                        <i class="fas fa-download"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-title">Lượt tải</div>
                        <div class="stat-value">25.4K</div>
                        <div class="stat-trend positive">
                            <i class="fas fa-arrow-up"></i> 6.5% 
                            <span class="trend-period">so với tháng trước</span>
                        </div>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon revenue-icon">
                        <i class="fas fa-coins"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-title">Doanh thu</div>
                        <div class="stat-value">562.8K xu</div>
                        <div class="stat-trend negative">
                            <i class="fas fa-arrow-down"></i> 2.3% 
                            <span class="trend-period">so với tháng trước</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Main Charts -->
            <div class="analytics-grid">
                <!-- Traffic Chart -->
                <div class="analytics-card double-width">
                    <div class="analytics-header">
                        <h3>Lượt truy cập</h3>
                        <div class="analytics-actions">
                            <div class="chart-type-toggle">
                                <button class="chart-type active" data-type="line">
                                    <i class="fas fa-chart-line"></i>
                                </button>
                                <button class="chart-type" data-type="bar">
                                    <i class="fas fa-chart-bar"></i>
                                </button>
                            </div>
                            <div class="analytics-dropdown">
                                <button class="dropdown-toggle">
                                    <span>Tháng này</span>
                                    <i class="fas fa-chevron-down"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="analytics-content">
                        <div class="chart-container">
                            <canvas id="trafficChart"></canvas>
                        </div>
                        <div class="chart-legend">
                            <div class="legend-item">
                                <div class="legend-color" style="background-color: var(--primary);"></div>
                                <div class="legend-label">Tổng lượt truy cập</div>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background-color: var(--success);"></div>
                                <div class="legend-label">Người dùng mới</div>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background-color: var(--warning);"></div>
                                <div class="legend-label">Lượt tải</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- User Growth Chart -->
                <div class="analytics-card">
                    <div class="analytics-header">
                        <h3>Tăng trưởng người dùng</h3>
                        <div class="analytics-actions">
                            <div class="analytics-dropdown">
                                <button class="dropdown-toggle">
                                    <span>Năm nay</span>
                                    <i class="fas fa-chevron-down"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="analytics-content">
                        <div class="chart-container">
                            <canvas id="userGrowthChart"></canvas>
                        </div>
                    </div>
                </div>
                
                <!-- Category Distribution Pie Chart -->
                <div class="analytics-card">
                    <div class="analytics-header">
                        <h3>Phân bố theo danh mục</h3>
                        <div class="analytics-actions">
                            <div class="analytics-dropdown">
                                <button class="dropdown-toggle">
                                    <span>Tài liệu mới</span>
                                    <i class="fas fa-chevron-down"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="analytics-content">
                        <div class="chart-container">
                            <canvas id="categoryDistributionChart"></canvas>
                        </div>
                    </div>
                </div>
                
                <!-- Document Type Donut Chart -->
                <div class="analytics-card">
                    <div class="analytics-header">
                        <h3>Phân loại tài liệu</h3>
                        <div class="analytics-actions">
                            <div class="analytics-dropdown">
                                <button class="dropdown-toggle">
                                    <span>Tất cả</span>
                                    <i class="fas fa-chevron-down"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="analytics-content">
                        <div class="chart-container">
                            <canvas id="documentTypeChart"></canvas>
                        </div>
                    </div>
                </div>
                
                <!-- Top Documents Table -->
                <div class="analytics-card">
                    <div class="analytics-header">
                        <h3>Tài liệu phổ biến nhất</h3>
                        <div class="analytics-actions">
                            <div class="analytics-dropdown">
                                <button class="dropdown-toggle">
                                    <span>Theo lượt tải</span>
                                    <i class="fas fa-chevron-down"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="analytics-content">
                        <table class="analytics-table">
                            <thead>
                                <tr>
                                    <th>Tài liệu</th>
                                    <th>Danh mục</th>
                                    <th>Lượt tải</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>
                                        <div class="table-document">
                                            <div class="document-icon"><i class="fas fa-file-pdf"></i></div>
                                            <div class="document-title">Lập trình ứng dụng web với React</div>
                                        </div>
                                    </td>
                                    <td>Công nghệ thông tin</td>
                                    <td>
                                        <div class="table-number">5.2K</div>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <div class="table-document">
                                            <div class="document-icon"><i class="fas fa-file-word"></i></div>
                                            <div class="document-title">IELTS Writing: Cách đạt điểm cao</div>
                                        </div>
                                    </td>
                                    <td>Ngoại ngữ</td>
                                    <td>
                                        <div class="table-number">4.8K</div>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <div class="table-document">
                                            <div class="document-icon"><i class="fas fa-file-powerpoint"></i></div>
                                            <div class="document-title">Quản trị chiến lược kinh doanh</div>
                                        </div>
                                    </td>
                                    <td>Kinh tế - Quản trị</td>
                                    <td>
                                        <div class="table-number">3.6K</div>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <div class="table-document">
                                            <div class="document-icon"><i class="fas fa-file-pdf"></i></div>
                                            <div class="document-title">Python cho Data Science</div>
                                        </div>
                                    </td>
                                    <td>Công nghệ thông tin</td>
                                    <td>
                                        <div class="table-number">3.2K</div>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <div class="table-document">
                                            <div class="document-icon"><i class="fas fa-file-pdf"></i></div>
                                            <div class="document-title">Giải tích 1 cho sinh viên kỹ thuật</div>
                                        </div>
                                    </td>
                                    <td>Khoa học tự nhiên</td>
                                    <td>
                                        <div class="table-number">2.9K</div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Top Users Table -->
                <div class="analytics-card">
                    <div class="analytics-header">
                        <h3>Người dùng tích cực nhất</h3>
                        <div class="analytics-actions">
                            <div class="analytics-dropdown">
                                <button class="dropdown-toggle">
                                    <span>Theo số tài liệu</span>
                                    <i class="fas fa-chevron-down"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="analytics-content">
                        <table class="analytics-table">
                            <thead>
                                <tr>
                                    <th>Người dùng</th>
                                    <th>Số tài liệu</th>
                                    <th>Xu kiếm được</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>
                                        <div class="table-user">
                                            <img src="https://images.unsplash.com/photo-1535713875002-d1d0cf377fde?ixlib=rb-1.2.1&auto=format&fit=crop&w=40&h=40&q=80" alt="User">
                                            <div class="user-name">Nguyễn Văn A</div>
                                        </div>
                                    </td>
                                    <td>126</td>
                                    <td>
                                        <div class="table-number">28.5K</div>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <div class="table-user">
                                            <img src="https://images.unsplash.com/photo-1494790108377-be9c29b29330?ixlib=rb-1.2.1&auto=format&fit=crop&w=40&h=40&q=80" alt="User">
                                            <div class="user-name">Trần Thị B</div>
                                        </div>
                                    </td>
                                    <td>98</td>
                                    <td>
                                        <div class="table-number">22.3K</div>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <div class="table-user">
                                            <img src="https://images.unsplash.com/photo-1570295999919-56ceb5ecca61?ixlib=rb-1.2.1&auto=format&fit=crop&w=40&h=40&q=80" alt="User">
                                            <div class="user-name">Lê Văn C</div>
                                        </div>
                                    </td>
                                    <td>87</td>
                                    <td>
                                        <div class="table-number">19.8K</div>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <div class="table-user">
                                            <img src="https://images.unsplash.com/photo-1438761681033-6461ffad8d80?ixlib=rb-1.2.1&auto=format&fit=crop&w=40&h=40&q=80" alt="User">
                                            <div class="user-name">Phạm Thị D</div>
                                        </div>
                                    </td>
                                    <td>75</td>
                                    <td>
                                        <div class="table-number">16.2K</div>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <div class="table-user">
                                            <img src="https://images.unsplash.com/photo-1500648767791-00dcc994a43e?ixlib=rb-1.2.1&auto=format&fit=crop&w=40&h=40&q=80" alt="User">
                                            <div class="user-name">Hoàng Văn E</div>
                                        </div>
                                    </td>
                                    <td>64</td>
                                    <td>
                                        <div class="table-number">14.7K</div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Revenue Chart -->
                <div class="analytics-card double-width">
                    <div class="analytics-header">
                        <h3>Doanh thu</h3>
                        <div class="analytics-actions">
                            <div class="chart-type-toggle">
                                <button class="chart-type active" data-type="bar">
                                    <i class="fas fa-chart-bar"></i>
                                </button>
                                <button class="chart-type" data-type="line">
                                    <i class="fas fa-chart-line"></i>
                                </button>
                            </div>
                            <div class="analytics-dropdown">
                                <button class="dropdown-toggle">
                                    <span>6 tháng gần đây</span>
                                    <i class="fas fa-chevron-down"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="analytics-content">
                        <div class="chart-container">
                            <canvas id="revenueChart"></canvas>
                        </div>
                        <div class="chart-stats">
                            <div class="stat-item">
                                <div class="stat-value">562.8K</div>
                                <div class="stat-label">Tổng doanh thu</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value">168.8K</div>
                                <div class="stat-label">Doanh thu cao nhất (tháng 3)</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value">94K</div>
                                <div class="stat-label">Doanh thu trung bình/tháng</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Export Options -->
            <div class="export-options">
                <h3>Xuất báo cáo</h3>
                <div class="export-buttons">
                    <button class="export-btn">
                        <i class="fas fa-file-pdf"></i> PDF
                    </button>
                    <button class="export-btn">
                        <i class="fas fa-file-excel"></i> Excel
                    </button>
                    <button class="export-btn">
                        <i class="fas fa-file-csv"></i> CSV
                    </button>
                    <button class="export-btn">
                        <i class="fas fa-print"></i> In
                    </button>
                </div>
            </div>
        </main>
    </div>
    
    <script src="../js/main.js"></script>
    <script src="js/admin.js"></script>
    
    
    <!-- Admin specific scripts -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Admin dropdown toggle
            const adminProfile = document.querySelector('.admin-profile');
            if(adminProfile) {
                adminProfile.addEventListener('click', function() {
                    this.classList.toggle('active');
                });
            }
            
            // Chart.js - Default Configuration
            Chart.defaults.font.family = '"Nunito", sans-serif';
            Chart.defaults.color = '#64748b';
            Chart.defaults.responsive = true;
            Chart.defaults.maintainAspectRatio = false;
            
            // Check if dark mode is active
            const isDarkMode = document.body.classList.contains('dark-mode');
            const gridColor = isDarkMode ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.05)';
            
            // Traffic Chart
            const trafficChartCtx = document.getElementById('trafficChart').getContext('2d');
            const trafficChart = new Chart(trafficChartCtx, {
                type: 'line',
                data: {
                    labels: ['1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12', '13', '14', '15', '16', '17', '18', '19', '20', '21', '22', '23', '24', '25', '26', '27', '28', '29', '30'],
                    datasets: [{
                        label: 'Tổng lượt truy cập',
                        data: [1200, 1300, 1250, 1420, 1650, 1700, 1800, 1750, 1900, 2100, 2200, 2300, 2400, 2350, 2500, 2600, 2700, 2650, 2800, 2900, 3100, 3200, 3300, 3250, 3400, 3500, 3600, 3650, 3800, 4000],
                        borderColor: '#4361ee',
                        backgroundColor: 'rgba(67, 97, 238, 0.1)',
                        tension: 0.4,
                        fill: true
                    }, 
                    {
                        label: 'Người dùng mới',
                        data: [200, 220, 210, 240, 250, 260, 280, 270, 290, 310, 330, 350, 370, 360, 380, 400, 420, 410, 430, 450, 470, 490, 510, 500, 520, 540, 560, 550, 580, 600],
                        borderColor: '#10b981',
                        backgroundColor: 'rgba(16, 185, 129, 0.1)',
                        tension: 0.4,
                        fill: true
                    },
                    {
                        label: 'Lượt tải',
                        data: [500, 520, 510, 530, 550, 570, 590, 580, 600, 620, 640, 660, 680, 670, 690, 710, 730, 720, 750, 780, 810, 840, 870, 860, 890, 920, 950, 940, 970, 1000],
                        borderColor: '#f59e0b',
                        backgroundColor: 'rgba(245, 158, 11, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    interaction: {
                        mode: 'index',
                        intersect: false,
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.dataset.label + ': ' + context.parsed.y.toLocaleString();
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            grid: {
                                display: false
                            },
                            title: {
                                display: true,
                                text: 'Ngày (tháng 4)'
                            }
                        },
                        y: {
                            grid: {
                                color: gridColor
                            },
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    if (value >= 1000) {
                                        return (value / 1000).toFixed(1) + 'K';
                                    }
                                    return value;
                                }
                            }
                        }
                    }
                }
            });
            
            // User Growth Chart
            const userGrowthChartCtx = document.getElementById('userGrowthChart').getContext('2d');
            const userGrowthChart = new Chart(userGrowthChartCtx, {
                type: 'line',
                data: {
                    labels: ['T1', 'T2', 'T3', 'T4', 'T5', 'T6', 'T7', 'T8', 'T9', 'T10', 'T11', 'T12'],
                    datasets: [{
                        label: 'Người dùng mới',
                        data: [850, 920, 980, 1245, 1400, 1520, 1650, 1780, 1900, 2150, 2350, 2500],
                        borderColor: '#4361ee',
                        backgroundColor: 'rgba(67, 97, 238, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.dataset.label + ': ' + context.parsed.y.toLocaleString();
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            grid: {
                                display: false
                            }
                        },
                        y: {
                            grid: {
                                color: gridColor
                            },
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    if (value >= 1000) {
                                        return (value / 1000).toFixed(1) + 'K';
                                    }
                                    return value;
                                }
                            }
                        }
                    }
                }
            });
            
            // Category Distribution Chart
            const categoryDistributionChartCtx = document.getElementById('categoryDistributionChart').getContext('2d');
            const categoryDistributionChart = new Chart(categoryDistributionChartCtx, {
                type: 'pie',
                data: {
                    labels: ['Công nghệ thông tin', 'Kinh tế - Quản trị', 'Ngoại ngữ', 'Kỹ thuật - Công nghệ', 'Khoa học xã hội', 'Khoa học tự nhiên'],
                    datasets: [{
                        data: [35, 25, 15, 10, 8, 7],
                        backgroundColor: [
                            '#4361ee', '#f72585', '#10b981', '#f59e0b', '#8b5cf6', '#ef4444'
                        ]
                    }]
                },
                options: {
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 20,
                                boxWidth: 12,
                                font: {
                                    size: 11
                                }
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.label + ': ' + context.parsed + '%';
                                }
                            }
                        }
                    }
                }
            });
            
            // Document Type Chart
            const documentTypeChartCtx = document.getElementById('documentTypeChart').getContext('2d');
            const documentTypeChart = new Chart(documentTypeChartCtx, {
                type: 'doughnut',
                data: {
                    labels: ['PDF', 'Word', 'PowerPoint', 'Excel', 'Khác'],
                    datasets: [{
                        data: [45, 25, 15, 10, 5],
                        backgroundColor: [
                            '#ef4444', '#4361ee', '#f59e0b', '#10b981', '#8b5cf6'
                        ]
                    }]
                },
                options: {
                    cutout: '60%',
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 20,
                                boxWidth: 12,
                                font: {
                                    size: 11
                                }
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.label + ': ' + context.parsed + '%';
                                }
                            }
                        }
                    }
                }
            });
            
            // Revenue Chart
            const revenueChartCtx = document.getElementById('revenueChart').getContext('2d');
            const revenueChart = new Chart(revenueChartCtx, {
                type: 'bar',
                data: {
                    labels: ['T11/2022', 'T12/2022', 'T1/2023', 'T2/2023', 'T3/2023', 'T4/2023'],
                    datasets: [{
                        label: 'Doanh thu',
                        data: [85400, 97600, 112500, 98500, 168800, 85600],
                        backgroundColor: 'rgba(67, 97, 238, 0.8)',
                        borderColor: '#4361ee',
                        borderWidth: 1,
                        borderRadius: 4
                    }]
                },
                options: {
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.dataset.label + ': ' + context.parsed.y.toLocaleString() + ' xu';
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            grid: {
                                display: false
                            }
                        },
                        y: {
                            grid: {
                                color: gridColor
                            },
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    if (value >= 1000) {
                                        return (value / 1000).toFixed(0) + 'K';
                                    }
                                    return value;
                                }
                            }
                        }
                    }
                }
            });
            
            // Chart Type Toggle
            const chartTypeButtons = document.querySelectorAll('.chart-type');
            
            chartTypeButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const parent = this.closest('.analytics-header');
                    if (!parent) return;
                    
                    const buttons = parent.querySelectorAll('.chart-type');
                    buttons.forEach(btn => btn.classList.remove('active'));
                    this.classList.add('active');
                    
                    const chartType = this.getAttribute('data-type');
                    const chartContainer = this.closest('.analytics-card').querySelector('.chart-container canvas');
                    
                    let chartInstance;
                    if (chartContainer.id === 'trafficChart') {
                        chartInstance = trafficChart;
                    } else if (chartContainer.id === 'revenueChart') {
                        chartInstance = revenueChart;
                    } else {
                        return;
                    }
                    
                    chartInstance.config.type = chartType;
                    chartInstance.update();
                });
            });
            
            // Date Range Presets
            const timePresets = document.querySelectorAll('.time-preset');
            const startDateInput = document.getElementById('startDate');
            const endDateInput = document.getElementById('endDate');
            
            timePresets.forEach(preset => {
                preset.addEventListener('click', function() {
                    timePresets.forEach(p => p.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Calculate date range based on preset
                    const days = parseInt(this.getAttribute('data-days'));
                    const endDate = new Date();
                    const startDate = new Date();
                    startDate.setDate(endDate.getDate() - days);
                    
                    // Update date inputs
                    startDateInput.value = formatDate(startDate);
                    endDateInput.value = formatDate(endDate);
                });
            });
            
            function formatDate(date) {
                const year = date.getFullYear();
                const month = String(date.getMonth() + 1).padStart(2, '0');
                const day = String(date.getDate()).padStart(2, '0');
                return `${year}-${month}-${day}`;
            }
            
            // Handle dark mode toggle for charts
            const darkModeToggle = document.getElementById('darkModeToggle');
            if (darkModeToggle) {
                darkModeToggle.addEventListener('click', function() {
                    // Update chart colors when dark mode changes
                    setTimeout(() => {
                        const isDarkMode = document.body.classList.contains('dark-mode');
                        const gridColor = isDarkMode ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.05)';
                        
                        // Update grid colors for each chart
                        [trafficChart, userGrowthChart, revenueChart].forEach(chart => {
                            if (chart.config.options.scales.y) {
                                chart.config.options.scales.y.grid.color = gridColor;
                                chart.update();
                            }
                        });
                        
                        // Update font colors for all charts
                        Chart.defaults.color = isDarkMode ? '#94a3b8' : '#64748b';
                        [trafficChart, userGrowthChart, categoryDistributionChart, documentTypeChart, revenueChart].forEach(chart => {
                            chart.update();
                        });
                    }, 100);
                });
            }
        });
    </script>
    
    <style>
        /* Additional styles specific to statistics page */
        .date-filter {
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }
        
        .date-picker {
            display: flex;
            align-items: center;
        }
        
        .date-inputs {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .date-field {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }
        
        .date-field label {
            font-size: 0.75rem;
            color: var(--gray-500);
        }
        
        .date-field input {
            padding: 0.5rem;
            border: 1px solid var(--gray-300);
            border-radius: var(--radius);
            font-size: 0.875rem;
            color: var(--gray-700);
            background-color: var(--white);
            width: 150px;
        }
        
        .date-separator {
            width: 16px;
            height: 1px;
            background-color: var(--gray-300);
            margin-top: 1rem;
        }
        
        .time-presets {
            display: flex;
            gap: 0.5rem;
        }
        
        .time-preset {
            padding: 0.5rem 1rem;
            border: 1px solid var(--gray-300);
            border-radius: var(--radius);
            font-size: 0.875rem;
            color: var(--gray-700);
            background-color: var(--white);
            cursor: pointer;
            transition: var(--transition-normal);
        }
        
        .time-preset.active {
            background-color: var(--primary);
            color: var(--white);
            border-color: var(--primary);
        }
        
        .apply-filter-btn {
            padding: 0.5rem 1.25rem;
            background-color: var(--primary);
            color: var(--white);
            border: none;
            border-radius: var(--radius);
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition-normal);
        }
        
        .apply-filter-btn:hover {
            background-color: var(--secondary);
        }
        
        .stats-summary {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }
        
        .stat-card {
            background-color: var(--white);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow);
            padding: 1.5rem;
            display: flex;
            align-items: center;
            gap: 1.25rem;
        }
        
        .stat-icon {
            width: 3.5rem;
            height: 3.5rem;
            border-radius: var(--radius);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }
        
        .users-icon {
            background-color: rgba(67, 97, 238, 0.1);
            color: var(--primary);
        }
        
        .documents-icon {
            background-color: rgba(247, 37, 133, 0.1);
            color: #f72585;
        }
        
        .downloads-icon {
            background-color: rgba(16, 185, 129, 0.1);
            color: var(--success);
        }
        
        .revenue-icon {
            background-color: rgba(245, 158, 11, 0.1);
            color: var(--warning);
        }
        
        .stat-content {
            flex: 1;
        }
        
        .stat-title {
            font-size: 0.875rem;
            color: var(--gray-600);
            margin-bottom: 0.25rem;
        }
        
        .stat-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--gray-900);
            margin-bottom: 0.5rem;
        }
        
        .stat-trend {
            font-size: 0.75rem;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }
        
        .stat-trend.positive {
            color: var(--success);
        }
        
        .stat-trend.negative {
            color: var(--error);
        }
        
        .trend-period {
            color: var(--gray-500);
            font-weight: 400;
        }
        
        .analytics-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }
        
        .analytics-card {
            background-color: var(--white);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow);
            overflow: hidden;
        }
        
        .analytics-card.double-width {
            grid-column: span 2;
        }
        
        .analytics-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.25rem 1.5rem;
            border-bottom: 1px solid var(--gray-200);
        }
        
        .analytics-header h3 {
            font-size: 1rem;
            font-weight: 600;
            color: var(--gray-800);
            margin: 0;
        }
        
        .analytics-actions {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .chart-type-toggle {
            display: flex;
            border: 1px solid var(--gray-300);
            border-radius: var(--radius);
            overflow: hidden;
        }
        
        .chart-type {
            padding: 0.5rem;
            font-size: 0.875rem;
            background-color: var(--white);
            border: none;
            cursor: pointer;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .chart-type:not(:last-child) {
            border-right: 1px solid var(--gray-300);
        }
        
        .chart-type.active {
            background-color: var(--primary);
            color: var(--white);
        }
        
        .analytics-dropdown {
            position: relative;
        }
        
        .dropdown-toggle {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            border: 1px solid var(--gray-300);
            border-radius: var(--radius);
            font-size: 0.875rem;
            background-color: var(--white);
            color: var(--gray-700);
            cursor: pointer;
        }
        
        .dropdown-toggle i {
            font-size: 0.75rem;
        }
        
        .analytics-content {
            padding: 1.5rem;
        }
        
        .chart-container {
            position: relative;
            height: 250px;
            margin-bottom: 1rem;
        }
        
        .chart-legend {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 1.5rem;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .legend-color {
            width: 12px;
            height: 12px;
            border-radius: 3px;
        }
        
        .legend-label {
            font-size: 0.875rem;
            color: var(--gray-600);
        }
        
        .chart-stats {
            display: flex;
            justify-content: space-between;
            margin-top: 1rem;
            border-top: 1px solid var(--gray-200);
            padding-top: 1rem;
        }
        
        .chart-stats .stat-item {
            text-align: center;
        }
        
        .chart-stats .stat-value {
            font-size: 1.25rem;
            margin-bottom: 0.25rem;
        }
        
        .chart-stats .stat-label {
            font-size: 0.75rem;
            color: var(--gray-500);
        }
        
        .analytics-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .analytics-table th {
            padding: 0.75rem 1rem;
            text-align: left;
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--gray-500);
            border-bottom: 1px solid var(--gray-200);
        }
        
        .analytics-table td {
            padding: 0.75rem 1rem;
            font-size: 0.875rem;
            color: var(--gray-700);
            border-bottom: 1px solid var(--gray-200);
        }
        
        .analytics-table tr:last-child td {
            border-bottom: none;
        }
        
        .table-document {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }
        
        .document-icon {
            width: 32px;
            height: 32px;
            border-radius: var(--radius);
            background-color: var(--gray-100);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--gray-600);
        }
        
        .document-title {
            font-weight: 500;
            color: var(--gray-800);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 150px;
        }
        
        .table-number {
            font-weight: 600;
            color: var(--gray-800);
        }
        
        .table-user {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }
        
        .table-user img {
            width: 32px;
            height: 32px;
            border-radius: var(--radius-full);
            object-fit: cover;
        }
        
        .user-name {
            font-weight: 500;
            color: var(--gray-800);
        }
        
        .export-options {
            background-color: var(--white);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }
        
        .export-options h3 {
            font-size: 1rem;
            font-weight: 600;
            color: var(--gray-800);
            margin-bottom: 1rem;
        }
        
        .export-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
        }
        
        .export-btn {
            padding: 0.75rem 1.5rem;
            border: 1px solid var(--gray-300);
            border-radius: var(--radius);
            background-color: var(--white);
            color: var(--gray-700);
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition-normal);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .export-btn:hover {
            background-color: var(--gray-100);
            border-color: var(--gray-400);
        }
        
        /* Dark Mode Styles */
        body.dark-mode .date-field input,
        body.dark-mode .time-preset,
        body.dark-mode .stat-card,
        body.dark-mode .analytics-card,
        body.dark-mode .export-options,
        body.dark-mode .chart-type,
        body.dark-mode .dropdown-toggle,
        body.dark-mode .export-btn {
            background-color: var(--gray-800);
            border-color: var(--gray-700);
            color: var(--gray-300);
        }
        
        body.dark-mode .date-field label,
        body.dark-mode .stat-title,
        body.dark-mode .trend-period,
        body.dark-mode .legend-label,
        body.dark-mode .analytics-table th {
            color: var(--gray-400);
        }
        
        body.dark-mode .date-separator {
            background-color: var(--gray-600);
        }
        
        body.dark-mode .stat-value,
        body.dark-mode .analytics-header h3,
        body.dark-mode .document-title,
        body.dark-mode .table-number,
        body.dark-mode .user-name,
        body.dark-mode .export-options h3 {
            color: var(--gray-200);
        }
        
        body.dark-mode .analytics-header {
            border-color: var(--gray-700);
        }
        
        body.dark-mode .chart-stats {
            border-color: var(--gray-700);
        }
        
        body.dark-mode .analytics-table td {
            color: var(--gray-300);
            border-color: var(--gray-700);
        }
        
        body.dark-mode .document-icon {
            background-color: var(--gray-700);
            color: var(--gray-400);
        }
        
        /* Responsive Styles */
        @media (max-width: 1200px) {
            .analytics-grid {
                grid-template-columns: 1fr;
            }
            
            .analytics-card.double-width {
                grid-column: span 1;
            }
        }
        
        @media (max-width: 768px) {
            .stats-summary {
                grid-template-columns: 1fr;
            }
            
            .date-filter {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .date-inputs {
                width: 100%;
                justify-content: space-between;
            }
            
            .time-presets {
                width: 100%;
                justify-content: space-between;
            }
            
            .time-preset {
                flex: 1;
                text-align: center;
            }
            
            .apply-filter-btn {
                width: 100%;
            }
            
            .chart-stats {
                flex-direction: column;
                gap: 1rem;
                align-items: center;
            }
        }
    </style>
</body>
</html>
